!function(){function t(){return{numerator:new i.N,denominator:(new i.N).set(1)}}function r(t,r){return t=t==this?new i(t):i(t),t.number.sign=t.sign*r,this.number.sign=this.sign,this.number=i.N.combine(this.number,t.number),this.isFractional()&&(this.remainder.numerator.sign=this.sign,t.isFractional()&&!t.remainder.numerator.isZero()&&(t.remainder.numerator.sign=t.sign*r,this.remainder.numerator=i.N.combine(this.remainder.numerator.copy().multiply(t.remainder.denominator),t.remainder.numerator.copy().multiply(this.remainder.denominator)),this.remainder.denominator.multiply(t.remainder.denominator)),this.remainder.numerator.sign!=this.number.sign&&(this.number.isZero()?this.number.sign=-this.number.sign:(this.number=i.N.combine(this.number,(new i.N).set(1).setSign(this.remainder.numerator.sign)),this.number.isZero()&&(this.number.sign=-this.remainder.numerator.sign),this.remainder.numerator=i.N.combine(this.remainder.numerator.setSign(-1),this.remainder.denominator))),this.normaliseRemainder()),this.sign=this.number.sign,this}var i=function(r,e){function n(){for(var t=new i.N;a<r.length&&/^\d$/.test(r[a]);a++)t.digitmultiply(10,parseInt(r[a]));return t}function o(){for(var i=t(),e=null;a<r.length;a++)if("["!=r[a]||null!==e){if(e&&"]"==r[a]){if(a!=r.length-1)throw new Error("No characters should follow the closure of the recurring part");if(i.numerator.isZero())throw new Error("At least one digit needs to follow the recurring indicator ([)");if("["==r[a-1])throw new Error("N not valid - empty recurring section");return i.numerator.subtract(e.numerator),i.denominator.subtract(e.denominator),i}if(!/^\d$/.test(r[a]))throw new Error("N not valid - unrecognised character after decimal point");i.denominator.digitmultiply(10,0),i.numerator.digitmultiply(10,parseInt(r[a]))}else e={numerator:i.numerator.copy(),denominator:i.denominator.copy()};if(e)throw new Error("Number not valid - incomplete recurring section");return i}function s(){var t={};if(t.numerator=n(),a==r.length||"/"!=r[a]||t.numerator.isZero())throw new Error("Number not valid - fractional numerator not a positive integer");if(a++,t.denominator=n(),a!=r.length||t.denominator.isZero())throw new Error("Number not valid - fractional denominator not a positive integer");return t}function h(t){var r=t.numerator.divide(t.denominator),i=t.numerator;return t.numerator=r,i}if(!(this instanceof i)){if(r instanceof i&&("boolean"!=typeof e||e==r.integer))return r;switch(arguments.length){case 0:return new i;case 1:return new i(r);default:return new i(r,e)}}if(this.integer=!0,"boolean"==typeof r&&(this.integer=r),"boolean"==typeof e&&(this.integer=e),r instanceof i)return this.number=r.number.copy(),"boolean"!=typeof r&&r.isFractional()&&(this.integer=!1),this.integer||(r.isInteger()?this.remainder=t():this.remainder={numerator:r.remainder.numerator.copy(),denominator:r.remainder.denominator.copy()}),void(this.sign=r.sign);if("number"!=typeof r){if("string"==typeof r){this.sign="-"==r[0]?-1:1;var a="-"==r[0]||"+"==r[0]?1:0;if(this.number=n(),a==r.length)this.integer||(this.remainder=t());else{a++;var u;switch(r[a-1]){case".":"boolean"!=typeof e&&(this.integer=!1),this.integer||(this.remainder=o());break;case" ":"boolean"!=typeof e&&(this.integer=!1),u=s(),this.number.add(h(u).setSign(this.sign)),this.integer||(this.remainder=u);break;case"/":if(this.number.isZero())throw new Error("Number not valid - fraction only input must have a numerator");if("boolean"!=typeof e&&(this.integer=!1),u={numerator:this.number,denominator:n()},a!=r.length||u.denominator.isZero())throw new Error("Number not valid - fractional denominator must be a positive integer");this.number=h(u),this.integer||(this.remainder=u);break;default:throw new Error("Number not valid - unrecognised character in number")}}return void(this.isZero()&&(this.sign=1))}if("undefined"==typeof r&&arguments.length>0)throw Error("Initial value setting of TPA is undefined");this.number=new i.N,this.integer||(this.remainder={numerator:new i.N,denominator:(new i.N).set(1)}),this.sign=1}else{if(isNaN(r))throw new Error("N provided is not valid - NaN");this.sign=0>r?-1:1,r=Math.abs(r),this.number=(new i.N).set(Math.floor(r));var m=Math.floor(Math.log(i.N.BASE)/Math.log(10)),c=Math.pow(10,m),l=Math.floor((r-Math.floor(r)).toFixed(m)*c);if("boolean"!=typeof e||!this.integer){for("boolean"!=typeof e&&(this.integer=0==l);0!=l&&l%10==0;)l/=10,c/=10;(l>0||!this.integer)&&(this.integer=!1,this.remainder={numerator:(new i.N).fullshift(l),denominator:(new i.N).fullshift(c)})}}};i.prototype.simplify=function(t){if(arguments.length>0&&("number"!=typeof t||isNaN(t)))throw new Error("Simplify() takes an optional numeric argument specifying the maximum number of millisecondsto process");if("undefined"==typeof t&&(t=100),this.isInteger()||this.remainder.numerator.isZero())return!0;for(var r=this.remainder.numerator.roughSqrt().value(),e=new i.N.Primes,n=(new Date).getTime(),o=(new i.N).set(1),s=e.next();s>0&&r>=s;s=e.next()){for(;this.remainder.numerator.isDivisibleBy(s);)this.remainder.numerator.digitdivide(s),this.remainder.denominator.isDivisibleBy(s)?this.remainder.denominator.digitdivide(s):o.digitmultiply(s,0);var h=(new Date).getTime();if(h-n>t&&t>0){s=0;break}}var a=this.remainder.denominator.copy(),u=a.divide(this.remainder.numerator);return u.isZero()?(this.remainder.denominator=a,this.remainder.numerator=o,!0):(this.remainder.numerator.multiply(o),s>0)},i.prototype.makeInteger=function(){this.integer=!0,delete this.remainder},i.prototype.makeFractional=function(){this.integer=!1,this.remainder=t()},i.prototype.isInteger=function(){return this.integer},i.prototype.isFractional=function(){return!this.integer},i.prototype.isNegative=function(){return this.sign<0},i.prototype.isPositive=function(){return this.sign>0},i.prototype.isZero=function(){return this.number.isZero()&&(this.isInteger()||this.remainder.numerator.isZero())},i.prototype.hasFraction=function(){return this.integer?!1:!this.remainder.numerator.isZero()},i.prototype.value=function(){if(this.integer)return this.sign*this.number.value();var t=this.remainder.numerator.copy().fullshift(0).fullshift(0);return t.divide(this.remainder.denominator),this.sign*(this.number.value()+t.value()/Math.pow(i.N.BASE,2))},i["int"]=function(t){return new i(t["int"]())},i.frac=function(t){return new i(t.frac())},i.add=function(t,r){return new i(t).add(r)},i.subtract=function(t,r){return new i(t).subtract(r)},i.multiply=function(t,r){return new i(t).multiply(r)},i.divide=function(t,r){return new i(t).divide(r)},i.mod=function(t,r){return new i(t).mod(r)},i["int"]=function(t){return new i(t)["int"]()},i.random=function(t){if(!("number"==typeof t&&t>0))throw new Error("You must specify a positive number of decimal digits as an approximate size for this number");var r=new i;return r.number.random(t),r},i.prototype.compare=function(t){if(t=i(t),this.sign!=t.sign)return this.sign;var r=this.number.compare(t.number);return 0==r&&this.isFractional()&&(t.isFractional()?r=this.remainder.numerator.copy().multiply(t.remainder.denominator).compare(this.remainder.denominator.copy().multiply(t.remainder.numerator)):this.remainder.numerator.isZero()||(r=1)),r},i.prototype.lt=function(t){return-1==this.compare(t)},i.prototype.lte=function(t){return 1!=this.compare(t)},i.prototype.gt=function(t){return 1==this.compare(t)},i.prototype.gte=function(t){return-1!=this.compare(t)},i.prototype.eq=function(t){return 0==this.compare(t)},i.prototype["int"]=function(){return this.integer||(this.remainder.numerator.reset(),this.remainder.denominator.set(1)),this},i.prototype.frac=function(){return this.number.reset(),this},i.prototype.normaliseRemainder=function(){if(this.isFractional()){if(this.remainder.numerator.compare(this.remainder.denominator)>=0){var t=this.remainder.numerator.divide(this.remainder.denominator);i.N.combine(this.number,this.remainder.numerator),this.remainder.numerator=t}this.remainder.numerator.isZero()&&this.remainder.denominator.set(1)}},i.prototype.multiply=function(t){return t=t==this?new i(t):i(t),t.number.sign=1,this.number.sign=1,this.sign*=t.sign,this.isFractional()?(t.isFractional()?(this.remainder.numerator.multiply(i.N.combine(t.remainder.numerator.copy(),t.remainder.denominator.copy().multiply(t.number))),i.N.combine(this.remainder.numerator,t.remainder.numerator.copy().multiply(this.number).multiply(this.remainder.denominator)),this.remainder.denominator.multiply(t.remainder.denominator)):this.remainder.numerator.multiply(t.number),this.number.multiply(t.number),this.normaliseRemainder()):this.number.multiply(t.number),this},i.prototype.divide=function(t){return t=t==this?new i(t):i(t),t.number.sign=1,this.number.sign=1,this.sign*=t.sign,this.isFractional()?t.isFractional()?(i.N.combine(this.number.multiply(this.remainder.denominator),this.remainder.numerator).multiply(t.remainder.denominator),this.remainder.numerator=this.number.divide(this.remainder.denominator.multiply(i.N.combine(t.number.copy().multiply(t.remainder.denominator),t.remainder.numerator)))):(i.N.combine(this.number.multiply(this.remainder.denominator),this.remainder.numerator),this.remainder.numerator=this.number.divide(this.remainder.denominator.multiply(t.number))):this.number.divide(t.number),this},i.prototype.mod=function(r){return r=r==this?this.copy():i(r),this.number=this.number.divide(r.number),this.isFractional()&&(this.remainder=t()),this},i.prototype.subtract=function(t){return r.call(this,t,-1)},i.prototype.add=function(t){return r.call(this,t,1)},i.prototype.toDecimal=function(t){return this.toString(t)},i.prototype.toFraction=function(){if(this.isInteger())return this.toString();var t="";this.sign<0&&(t="-"+t);var r=new i;return r.number=this.number,t+=r.toString(),this.remainder.numerator.isZero()||(r.number=this.remainder.numerator,t=t+" "+r.toString(),r.number=this.remainder.denominator,t=t+"/"+r.toString()),t},i.prototype.toString=function(t){("number"!=typeof t||isNaN(t))&&(t=100);for(var r="",e=(new i.N).set(10),n=this.number.copy("fn_toString");!n.isZero();)r=n.divide(e).longs[0]+r;if(this.sign<0&&(r="-"+r),this.isFractional()&&!this.remainder.numerator.isZero()){this.number.isZero()&&(r+="0"),r+=".";for(var o=[],s=this.remainder.numerator.copy("fn_tostring"),h=0;!s.isZero()&&t>0;s=h,t--){for(var a=o.length-1;a>=0&&0!=o[a].compare(s);a--);if(a>=0){r=r.substr(0,r.length+a-o.length)+"["+r.substr(r.length+a-o.length)+"]";break}o.push(s.copy()),h=s.digitmultiply(10,0).divide(this.remainder.denominator),r+=s.longs[0]}0!=t||s.isZero()||(r+="...")}else this.number.isZero()&&(r="0");return r},i.N=function(){var t=Math.pow(2,32),r=Math.pow(2,16),i={},e=function(t){this.sign=1,this.longcount=0,this.shortcount=0,"number"==typeof t&&t>0||(t=8),this.setSize(t)};return e.prototype.setSize=function(t){if(!(this.size>t)){this.size=t;var r=new ArrayBuffer(8*this.size),i=new Uint32Array(r,0);this.longs&&i.set(this.longs),this.buffer=r,this.longs=i,this.shorts=new Uint16Array(r,0)}},e.prototype.overwrite=function(t){this.size!=t.size&&(this.size=t.size,this.buffer=new ArrayBuffer(8*this.size),this.longs=new Uint32Array(this.buffer,0),this.shorts=new Uint16Array(this.buffer,0)),this.longs.set(new Uint32Array(t.buffer,0,t.longcount)),this.sign=t.sign,this.longcount=t.longcount,this.shortcount=t.shortcount},e.prototype.copy=function(t){var r;return"undefined"==typeof t?r=new e(this.size):(t in i||(i[t]=[]),this.size in i[t]||(i[t][this.size]=new e(this.size)),r=i[t][this.size]),r.longs.set(new Uint32Array(this.buffer,0,this.longcount)),r.sign=this.sign,r.size=this.size,r.longcount=this.longcount,r.shortcount=this.shortcount,r},e.prototype.roughSqrt=function(){var t=new e,i=this.shorts[this.shortcount]*r+this.shorts[this.shortcount-1]+1,n=(this.shortcount-1+Math.log(i)/Math.log(r))/2;return t.setSize(Math.ceil(n)),t.shorts[Math.floor(n)]=Math.ceil(Math.pow(r,n-Math.floor(n))),t.setCount(2*Math.ceil(n))},e.prototype.isDivisibleBy=function(i){var e;if(r>i){for(e=this.longcount-1,n=0;e>=0;e--)n=n%i*t+this.longs[e];return n%i==0}if(t>i){for(e=this.shortcount-1,n=0;e>=0;e--)var n=n%i*r+this.shorts[e];return n%i==0}throw new Error("Internal error - isDivisibleBy() only accepts divisors less than N.BASE")},e.prototype.checkSize=function(t){8*(this.longcount/2+t)>this.buffer.byteLength&&this.setSize(Math.pow(2,Math.ceil(Math.log(this.size+t)/Math.log(2))))},e.prototype.isZero=function(){return 0==this.shortcount},e.prototype.value=function(){for(var r=0,i=this.longcount-1;i>=0;i--)r+=this.longs[i]*Math.pow(t,i);return r},e.prototype.compare=function(t){if(this.shortcount>t.shortcount)return 1;if(this.shortcount<t.shortcount)return-1;for(var r=this.longcount-1;r>=0;r--){if(this.longs[r]>t.longs[r])return 1;if(this.longs[r]<t.longs[r])return-1}return 0},e.prototype.setSign=function(t){return this.sign=t,this},e.combine=function(t,r){return 1==t.compare(r)?t.sign!=r.sign?t.subtract(r):t.add(r):t.sign!=r.sign?t.overwrite(r.copy("add_temp").subtract(t)):t.overwrite(r.copy("add_temp").add(t)),t},e.prototype.add=function(r){this.checkSize(1);for(var i=0,e=0;i<r.longcount||e;i++)e+=this.longs[i]+r.longs[i],this.longs[i]=e,e=Math.floor(e/t);return i>=this.longcount&&this.setCount(2*i),this},e.prototype.subtract=function(r){for(var i=0,e=0,n=0;i<r.longcount&&(i<this.longcount||n);i++)e=this.longs[i]-r.longs[i]-n,n=0>e?1:0,n?this.longs[i]=e+t:this.longs[i]=e;if(n&&i==this.longcount)throw new Error("This number MUST not be smaller than the number being subtracted");return this.setCount(this.shortcount)},e.prototype.subtractMultiple=function(r,i){for(var e=0,n=0,o=0;o<this.longcount;o++)e+=r.longs[o]*i,n=e%t,e=Math.floor(e/t),n>this.longs[o]?(this.longs[o]+=t-n,e++):this.longs[o]-=n;return this.setCount(this.shortcount)},e.prototype.setCount=function(t){for(this.shortcount=t;this.shortcount>0&&0==this.shorts[this.shortcount-1];)this.shortcount--;return this.longcount=Math.ceil(this.shortcount/2),this},e.prototype.digitmultiply=function(r,i){this.checkSize(1);for(var e=0;e<this.longcount;e++)i+=this.longs[e]*r,this.longs[e]=i,i=Math.floor(i/t);return i&&(this.longs[e]=i),this.setCount(2*(e+1))},e.prototype.digitdivide=function(i){if(i>=t)throw new Error("Internal error - fast divisor greater than base");var e,n,o=0;if(r>i)for(e=this.longcount-1;e>=0;e--)n=o*t+this.longs[e],this.longs[e]=Math.floor(n/i),o=n%i;else for(e=this.shortcount-1;e>=0;e--)n=o*r+this.shorts[e],this.shorts[e]=Math.floor(n/i),o=n%i;return this.setCount(this.shortcount),o},e.prototype.accumulate=function(r,i,e){this.checkSize(i.longcount+1);for(var n=0;n<r.longcount;n++){for(var o=0,s=0;o<i.longcount;o++)s+=r.longs[n]*i.shorts[2*o+e]+this.longs[n+o],this.longs[n+o]=s,s=Math.floor(s/t);s&&(this.longs[n+o]+=s)}return this.setCount(2*(n+o))},e.prototype.reset=function(){for(var t=0;t<this.longcount;t++)this.longs[t]=0;this.sign=1,this.setCount(0)},e.prototype.set=function(r){this.reset(),this.sign=0>r?-1:1,r=Math.abs(r);for(var i=0;0!=r;i++)i>0&&this.checkSize(1),this.longs[i]=r,r=Math.floor(r/t),this.longcount++;return this.setCount(2*i)},e.prototype.random=function(r){var i=Math.log(t)/Math.log(10);this.checkSize(Math.floor(r/i)+1-this.size);for(var e=0;r>i;e++)this.longs[e]=Math.floor(Math.random()*t),r-=i;return this.longs[e]=1+Math.floor(Math.random()*Math.pow(10,r)),this.setCount(2*(e+1))},e.prototype.multiply=function(t){if(this.isZero())return this;var i=this.copy("temp");return this.reset(),this.sign=i.sign*t.sign,this.accumulate(i,t,1).digitmultiply(r,0).accumulate(i,t,0)},e.prototype.halfshift=function(t){this.checkSize(1);for(var r=this.shortcount;r>=0;r--)this.shorts[r+1]=this.shorts[r];return this.shorts[0]=t,this.setCount(this.shortcount+1)},e.prototype.fullshift=function(t){this.checkSize(1);for(var r=this.longcount;r>=0;r--)this.longs[r+1]=this.longs[r];return this.longs[0]=t,this.setCount(this.shortcount+2)},e.prototype.divide=function(i){if(i.isZero())throw new Error("Attempt to divide by zero");var n=new e;if(!this.isZero())switch(this.sign*=i.sign,this.compare(i)){case-1:n=this.copy(),this.reset();break;case 0:this.set(1);break;case 1:if(1==i.longcount)n.set(this.digitdivide(i.longs[0]));else{for(var o=this.shortcount-1;o>=0;o--)for(n.halfshift(this.shorts[o]),this.shorts[o]=0;n.compare(i)>=0;){var s=Math.max(1,Math.floor((n.shorts[i.shortcount]*t+n.shorts[i.shortcount-1]*r+n.shorts[i.shortcount-2])/(i.shorts[i.shortcount-1]*r+i.shorts[i.shortcount-2]+1)));this.shorts[o]+=s,n.subtractMultiple(i,s)}this.setCount(this.shortcount)}}return n},e.ZERO=new e,e.ONE=(new e).set(1),e.TWO=(new e).set(2),e.BASE=t,e.Primes=function(){function t(){i={buffer:new Uint32Array(new ArrayBuffer(e),0),count:2,limit:e/4},i.buffer[0]=2,i.buffer[1]=3}function r(){this.iterator=0}var i,e=Math.pow(2,24);return r.prototype.next=function(){if("undefined"==typeof i&&t(),this.iterator<i.count)return i.buffer[this.iterator++];if(i.count==i.limit)return 0;var r=i.buffer[i.count-1];do{r+=2;for(var e=Math.sqrt(r),n=!0,o=0;o<i.count&&i.buffer[o]<=e;o++)if(r%i.buffer[o]==0){n=!1;break}}while(!n);return i.buffer[i.count++]=r,this.iterator++,r},r}(),e}(),i.minus=i.subtract,i.prototype.minus=i.prototype.subtract,i.times=i.multiply,i.prototype.times=i.prototype.multiply,i.div=i.divide,i.prototype.div=i.prototype.divide,"object"==typeof exports&&"undefined"!=typeof module?module.exports=i:"function"==typeof define&&define.amd?define(["Tpa"],i):"undefined"!=typeof window&&(window.Tpa=i)}();