!function(){function t(t,i){return{numerator:t instanceof h?t:new a.N,denominator:i instanceof h?i:new a.N(1)}}function i(t,i){if(!(this instanceof a)){if(t instanceof a&&("boolean"!=typeof i||i==t.integer))return t;switch(arguments.length){case 0:return new a;case 1:return new a(t);default:return new a(t,i)}}switch(arguments.length){case 0:return this.set();case 1:return this.set(t);default:return this.set(t,i)}}var e,r,n,s="Number initialisation parameter badly formed",o=8;Math.trunc=Math.trunc||function(t){return 0>t?Math.ceil(t):Math.floor(t)};var a=i;a.setBASE=function(t){e=t,r=Math.floor(Math.sqrt(e)),n=Math.pow(e,2)},a.getBASE=function(){return e},a.setBASE(Math.pow(2,25));var h=function(){var t=function(i){if(!(this instanceof t))return"undefined"==typeof i?new t:new t(i);if(this.reset(),0!=arguments.length)if(i instanceof t)this.digits=i.digits.slice(0),this.safemaximum=i.safemaximum;else if("number"==typeof i){if(isNaN(i))throw new Error(s);this.set(Math.trunc(i))}else{if("string"!=typeof i)throw new Error(s);for(var e="-"==i[0]?-1:1,r="-"==i[0]||"+"==i[0]?1:0;r<i.length&&/^\d$/.test(i[r]);r++)this._digitMultiplyWithAdd(10,e*parseInt(i[r]));if(r!=i.length)throw new Error(s)}};return t.prototype.normalise=function(t){if(this.safemaximum>=e){for(var i=0,r=0;i<this.digits.length;i++)r+=this.digits[i],this.digits[i]=r%e,r=Math.trunc(r/e);r&&(this.digits[this.digits.length]=r),this.safemaximum=e-1}if(t)return this;for(;this.digits.length>0&&0==this.digits[this.digits.length-1];)this.digits.length--;return this},t.prototype.positivise=function(){for(var t=0;t<this.digits.length;t++)this.digits[t]<0&&(this.digits[t]+=e,this.digits[t+1]--);for(;this.digits.length>0&&0==this.digits[this.digits.length-1];)this.digits.length--;return this},t.prototype.isNegative=function(){return this.isZero()?!1:this.digits[this.digits.length-1]<0},t.prototype.isZero=function(){return 0==this.normalise().digits.length},t.prototype.isPositive=function(){return this.isZero()?!1:this.digits[this.digits.length-1]>0},t.prototype.lsb=function(){return this.isZero()?0:(e+this.digits[0])%e},t.prototype.reset=function(){return this.digits=[],this.safemaximum=0,this},t.prototype.isDivisibleBy=function(t){if(e>t){for(var i=this.digits.length-1,r=0;i>=0;i--)r=r%t*e+this.digits[i];return r%t==0}},t.prototype.set=function(t){this.reset();for(var i=0;0!=t;i++)this.digits[i]=t%e,t=Math.trunc(t/e);return this.safemaximum=e-1,this},t.prototype.value=function(){for(var t=this.digits.length-1,i=0;t>=0;t--)i+=this.digits[t]*Math.pow(e,t);return i},t.prototype.compare=function(t){if(this.digits.length>t.digits.length)return 1;if(this.digits.length<t.digits.length)return-1;for(var i=this.digits.length-1;i>=0;i--){if(this.digits[i]>t.digits[i])return 1;if(this.digits[i]<t.digits[i])return-1}return 0},t.abs=function(i){return new t(i).abs()},t.prototype.abs=function(){return this.isNegative()&&this.negate(),this},t.prototype.add=function(t){var i;this.safemaximum=this.safemaximum+t.safemaximum,this.safemaximum>=n&&this.normalise();var e=this.digits.length;for(this.digits.length=Math.max(this.digits.length,t.digits.length),i=e;i<t.digits.length;i++)this.digits[i]=t.digits[i];for(i=Math.min(e,t.digits.length)-1;i>=0;i--)this.digits[i]+=t.digits[i];return this},t.prototype.negate=function(){for(var t=0;t<this.digits.length;t++)this.digits[t]=-this.digits[t];return this},t.prototype.subtract=function(t){var i;this.safemaximum=this.safemaximum+t.safemaximum,this.safemaximum>=n&&this.normalise();var e=this.digits.length;for(this.digits.length=Math.max(this.digits.length,t.digits.length),i=e;i<t.digits.length;i++)this.digits[i]=-t.digits[i];for(i=Math.min(e,t.digits.length)-1;i>=0;i--)this.digits[i]-=t.digits[i];return this},t.prototype.multiply=function(t){if(0==t.digits.length||0==this.digits.length)return this.reset();if(1==t.digits.length){var i=t.digits[0];if(this.safemaximum=this.safemaximum*Math.abs(i),this.safemaximum<n)for(var s=this.digits.length-1;s>=0;s--)this.digits[s]*=i;else this._digitMultiplyWithAdd(i,0);return this}t.safemaximum>=e&&t.normalise(),this.safemaximum>=e&&this.normalise();var o=t.digits,a=this.digits;this.digits=new Array(a.length+o.length-1);for(var s=0;s<this.digits.length;s++)this.digits[s]=0;return a.length>3&&o.length>3?this._rapidMultiplication(a,o,!0)._digitMultiplyWithAdd(r,0)._rapidMultiplication(a,o,!1):this._basicMultiplication(a,o)},t.prototype.digitMultiply=function(t){return this._digitMultiplyWithAdd(t,0)},t.prototype.random=function(t){this.reset();for(var i=Math.log(e)/Math.log(10),r=0;t>i;r++)this.digits[r]=Math.trunc(Math.random()*e),t-=i;return this.digits[r]=Math.trunc((1+Math.random())*Math.pow(10,t)),this.safemaximum=e-1,this},t.prototype.quotient=function(t){return this.divide(t),this},t.prototype.divide=function(i){var r,n,s=new t;if(i.safemaximum>=e&&i.normalise(),this.safemaximum>=e&&this.normalise(),0==this.digits.length)return s;if(0==i.digits.length)throw new Error("Attempt to divide by zero");if(1==i.digits.length)return s.set(this.digitDivide(i.digits[0]));var o=Math.sign(this.digits[this.digits.length-1]),a=Math.sign(i.digits[i.digits.length-1]);0>o?this.abs().positivise():this.positivise(),0>a?i.abs().positivise():i.positivise();var h=this.compare(i);switch(h){case-1:s=new t(this),this.reset();break;case 0:this.set(1);break;case 1:var m=i.digits,u=s.digits=this.digits.slice(this.digits.length-i.digits.length);s.safemaximum=this.safemaximum,this.digits.length-=u.length;var d;for(r=this.digits.length;r>=0;r--){for(this.digits[r]=0;s.compare(i)>=0;)d=u[u.length-1]*e+u[u.length-2],d=m.length<u.length?Math.max(1,Math.trunc(d/(m[m.length-1]+(m[m.length-2]+1)/e))):Math.max(1,Math.trunc(d/(m[m.length-1]*e+m[m.length-2]+1))),this.digits[r]+=d,s._subtractMultiple(m,d);if(r>0){for(n=u.length;n>0;n--)u[n]=u[n-1];u[0]=this.digits[r-1]}}}for(0>o*a&&(this.negate(),s.negate());this.digits.length>0&&0==this.digits[this.digits.length-1];)this.digits.length--;return s},t.prototype.digitDivide=function(t){for(var i,r=this.digits.length-1,n=0;r>=0;r--)i=n*e+this.digits[r],this.digits[r]=Math.trunc(i/t),n=i%t;for(;this.digits.length>0&&0==this.digits[this.digits.length-1];)this.digits.length--;return this.safemaximum=e-1,n},t.prototype.toString=function(){for(var i=this.isNegative()?"-":"",e=new t(this).abs().normalise().positivise();!e.isZero();)i=e.divide(t.TEN).lsb()+i;return 0==i.length&&(i="0"),i},t.prototype._digitMultiplyWithAdd=function(t,i){this.safemaximum>=e&&this.normalise(!0);for(var r=0;r<this.digits.length;r++)i+=this.digits[r]*t,this.digits[r]=i%e,i=Math.trunc(i/e);return i&&(this.digits[this.digits.length]=i),this.safemaximum=e-1,this},t.prototype._basicMultiplication=function(t,i){if(t.length>i.length){var r=t;t=i,i=r}for(var n=0,s=1,o=0,a=0;n<t.length;n++){for(o=t[n]%e,s=0,a=0;s<i.length;s++)a+=o*i[s]+this.digits[n+s],this.digits[n+s]=a%e,a=Math.trunc(a/e);a&&(this.digits[n+s]=a)}return this.safemaximum=e-1,this},t.prototype._rapidMultiplication=function(t,i,e){var n;if(t.length>i.length){var s=t;t=i,i=s}for(var o=t.length-1;o>=0;o--)if(n=e?Math.trunc(t[o]/r):t[o]%r,0!=n)for(var a=i.length-1;a>=0;a--)this.digits[o+a]+=n*i[a];return this.safemaximum*=r,this},t.prototype._subtractMultiple=function(t,i){for(var r=0,n=0,s=0;r<t.length;r++)n+=t[r]*i,s=n%e,n=Math.trunc(n/e),s>this.digits[r]?(this.digits[r]+=e-s,n++):this.digits[r]-=s;for(n&&(this.digits[r]-=n);this.digits.length>0&&0==this.digits[this.digits.length-1];)this.digits.length--},t.prototype._roughSqrt=function(){var i=new t;if(this.digits.length>0)if(1==this.digits.length)i.set(Math.ceil(Math.sqrt(this.digits[0])));else{var r=Math.ceil(Math.sqrt(this.digits[this.digits.length-1]*e+this.digits[this.digits.length-2]+1));i.digits=this.digits.slice(0,Math.trunc((this.digits.length-2)/2)),this.digits.length%2==1&&(r*=Math.sqrt(e)),i.digits.push(r%e)}return i},t.ZERO=new t,t.ONE=(new t).set(1),t.TWO=(new t).set(2),t.TEN=(new t).set(10),t.Primes=function(){function t(){this.iterator=0}var i=[2,3];return t.prototype.next=function(){if(this.iterator<i.length)return i[this.iterator++];var t=i[i.length-1];do{if(t+=2,t>=e)return 0;for(var r=Math.sqrt(t),n=!0,s=0;s<i.length&&i[s]<=r;s++)if(t%i[s]==0){n=!1;break}}while(!n);return i.push(t),this.iterator++,t},t}(),t}();a.prototype.set=function(i,e){function r(i,e){m.remainder=t();for(var r=0,n=null;r<i.length;r++)if("["!=i[r]||null!==n){if(n&&"]"==i[r])return m.remainder.numerator.subtract(n.numerator),m.remainder.denominator.subtract(n.denominator),this;m.remainder.denominator._digitMultiplyWithAdd(10,0),m.remainder.numerator._digitMultiplyWithAdd(10,e*parseInt(i[r]))}else n={numerator:new h(m.remainder.numerator),denominator:new h(m.remainder.denominator)};if(n)throw new Error(s)}function n(i){var e=t(new h(i.match(/^[\+\-]?\d+/)[0]),new h(i.match(/\/(\d+)$/)[1]));if(e.denominator.isZero())throw new Error(s);m.integer?m.number.add(e.numerator.quotient(e.denominator)):(m.remainder=e,m._normaliseRemainder())}var m=this;if(this.integer=!0,"boolean"==typeof i&&(this.integer=i),"boolean"==typeof e&&(this.integer=e),i instanceof a)return this.number=new h(i.number),"boolean"!=typeof e&&i.isFractional()&&(this.integer=!1),this.integer||(i.isInteger()?this.remainder=t():this.remainder={numerator:new h(i.remainder.numerator),denominator:new h(i.remainder.denominator)}),this;if("number"==typeof i){this.number=new h(i);var u=Math.pow(10,o),d=Math.trunc((i-Math.trunc(i)).toFixed(o)*u);if("boolean"!=typeof e||!this.integer){for("boolean"!=typeof e&&(this.integer=0==d);0!=d&&d%10==0;)d/=10,u/=10;(d>0||!this.integer)&&(this.integer=!1,this.remainder={numerator:new h(d),denominator:new h(u)})}return this}if("string"==typeof i){if(i=i.trim(),this.integer||(this.remainder=t()),i.match(/^[\+\-]?\d+\/\d+$/))"boolean"!=typeof e&&(this.integer=!1),this.number=new h,n(i);else{var g="-"==i[0];if(null===i.match(/^[\+\-]?\d*/))throw new Error(s);if(this.number=new h(i.match(/^[\+\-]?\d*/)[0]),i.match(/^[\+\-]?\d*$/))return this;var l=i.match(/^[\+\-]?\d*([\. ])/);if(null===l)throw new Error(s);var p=i.match(/^[\+\-]?\d*[\. ](.*)/)[1];switch("boolean"!=typeof e&&(this.integer=!1),l[1]){case".":if(null===p.match(/^\d*\[?\d+\]?$/))throw new Error(s);this.integer||r(p,g?-1:1);break;case" ":if(null===p.match(/^\d+\/\d+$/))throw new Error(s);n((g?"-":"")+p)}}return this}if("undefined"==typeof i&&arguments.length>0)throw new Error(s);return this.number=new a.N,this.integer||(this.remainder=t()),this},a.prototype.simplify=function(t){if(arguments.length>0&&("number"!=typeof t||isNaN(t)))throw new Error("Simplify() takes an optional numeric argument specifying the maximum number of millisecondsto process");if("undefined"==typeof t&&(t=100),this.isInteger()||this.remainder.numerator.isZero())return!0;for(var i=h.abs(this.remainder.numerator)._roughSqrt().value(),e=new a.N.Primes,r=(new Date).getTime(),n=(new a.N).set(1),s=e.next();s>0&&i>=s;s=e.next()){for(;this.remainder.numerator.isDivisibleBy(s);)this.remainder.numerator.digitDivide(s),this.remainder.denominator.isDivisibleBy(s)?this.remainder.denominator.digitDivide(s):n.digitMultiply(s);if((new Date).getTime()-r>t&&t>0){s=0;break}}var o=new h(this.remainder.denominator),m=o.divide(this.remainder.numerator);return m.isZero()?(this.remainder.denominator=o,this.remainder.numerator=n,!0):(this.remainder.numerator.multiply(n),s>0)},a.prototype.makeInteger=function(){return this.integer=!0,delete this.remainder,this},a.prototype.makeFractional=function(){return this.integer&&(this.integer=!1,this.remainder=t()),this},a.prototype.isInteger=function(){return this.integer},a.prototype.isFractional=function(){return!this.integer},a.prototype.isNegative=function(){return this.isZero()?!1:this.number.isZero()?this.remainder.numerator.isNegative():this.number.isNegative()},a.prototype.isPositive=function(){return this.isZero()?!1:this.number.isZero()?this.remainder.numerator.isPositive():this.number.isPositive()},a.prototype.isZero=function(){return this._normaliseRemainder(),this.number.isZero()&&(this.isInteger()||this.remainder.numerator.isZero())},a.prototype.sign=function(){return this.isZero()?0:this.isNegative()?-1:1},a.prototype.hasFraction=function(){return this.integer?!1:(this._normaliseRemainder(),!this.remainder.numerator.isZero())},a.prototype.value=function(){var t=Math.pow(10,o);if(this.integer)return this.number.value();var i=new h(this.remainder.numerator).multiply(new h(t));return i.divide(this.remainder.denominator),this.number.value()+1*(i.value()/t).toFixed(o)},a.makeFractional=function(t){return new a(t).makeFractional()},a.makeInteger=function(t){return new a(t).makeInteger()},a.frac=function(t){return new a(t).frac()},a["int"]=function(t){return new a(t)["int"]()},a.add=function(t,i){return new a(t).add(i)},a.subtract=function(t,i){return new a(t).subtract(i)},a.multiply=function(t,i){return new a(t).multiply(i)},a.divide=function(t,i){return new a(t).divide(i)},a.modulus=function(t,i){return new a(t).mod(i)},a.abs=function(t){return new a(t).abs()},a.random=function(t){if(!("number"==typeof t&&t>0))throw new Error("You must specify a positive number of decimal digits as an approximate size for this number");var i=new a;return i.number.random(t),i},a.prototype.compare=function(t){function i(t,i){return h.abs(t).normalise().positivise().compare(h.abs(i).positivise().normalise())}if(t===this)return 0;if(t=a(t),this._normaliseRemainder(),t._normaliseRemainder(),this.sign()!=t.sign())return 0==this.sign()?-t.sign():this.sign();var e=i(this.number,t.number);return 0==e&&this.isFractional()&&t.isFractional()&&(e=i(new h(this.remainder.numerator).multiply(t.remainder.denominator),new h(this.remainder.denominator).multiply(t.remainder.numerator))),e},a.prototype.lt=function(t){return-1==this.compare(t)},a.prototype.lte=function(t){return 1!=this.compare(t)},a.prototype.gt=function(t){return 1==this.compare(t)},a.prototype.gte=function(t){return-1!=this.compare(t)},a.prototype.eq=function(t){return 0==this.compare(t)},a.prototype["int"]=function(){return this.integer||(this.remainder=t()),this},a.prototype.frac=function(){return this._normaliseRemainder().number.reset(),this},a.prototype.abs=function(){return this.number.abs(),this.integer||this.remainder.numerator.abs(),this},a.prototype.multiply=function(t){return t instanceof i||(t=a(t)),this.integer||(t.integer?this.remainder.numerator.multiply(t.number):(this.remainder.numerator.multiply(new h(t.remainder.numerator).add(new h(t.remainder.denominator).multiply(t.number))),this.remainder.numerator.add(new h(t.remainder.numerator).multiply(this.number).multiply(this.remainder.denominator)),this.remainder.denominator.multiply(t.remainder.denominator))),this.number.multiply(t.number),this},a.prototype.divide=function(t){return t instanceof i||(t=a(t)),this.integer?this.number.divide(t.number):t.integer?(this.number.multiply(this.remainder.denominator).add(this.remainder.numerator),this.remainder.numerator=this.number.divide(this.remainder.denominator.multiply(t.number))):(this.number.multiply(this.remainder.denominator).add(this.remainder.numerator).multiply(t.remainder.denominator),this.remainder.numerator=this.number.divide(this.remainder.denominator.multiply(new h(t.number).multiply(t.remainder.denominator).add(t.remainder.numerator)))),this},a.prototype.modulus=function(e){return e instanceof i||(e=a(e)),this.number=this.number.divide(e.number),this.integer||(this.remainder=t()),this},a.prototype.subtract=function(t){return t instanceof i||(t=a(t)),this.number.subtract(t.number),this.integer||(t.integer||t.remainder.numerator.isZero()||(this.remainder.numerator.multiply(t.remainder.denominator),this.remainder.numerator.subtract(new h(t.remainder.numerator).multiply(this.remainder.denominator)),this.remainder.denominator.multiply(t.remainder.denominator)),this._normaliseRemainder()),this},a.prototype.add=function(t){return t instanceof i||(t=a(t)),this.number.add(t.number),this.integer||(t.integer||t.remainder.numerator.isZero()||(this.remainder.numerator.multiply(t.remainder.denominator),this.remainder.numerator.add(new h(t.remainder.numerator).multiply(this.remainder.denominator)),this.remainder.denominator.multiply(t.remainder.denominator)),this._normaliseRemainder()),this},a.prototype.toDecimal=function(t){return"undefined"==typeof t?this.toString():this.toString(t)},a.prototype.toInteger=function(){return this._normaliseRemainder(),(this.isNegative()?"-":"")+h.abs(this.number).toString()},a.prototype.toFraction=function(){var t=this.toInteger();return this.isFractional()&&!this.remainder.numerator.isZero()&&(t=t+" "+h.abs(this.remainder.numerator).toString(),t=t+"/"+this.remainder.denominator.toString()),t},a.prototype.toString=function(t){if("number"!=typeof t||isNaN(t)){if(arguments.length>0)throw new Error("toString() takes an optional parameter to specify the maximum DPs to output [default=100]");t=100}var i=this.toInteger();if(this.isFractional()&&!this.remainder.numerator.isZero()){i+=".";for(var e=[],r=new h(this.remainder.numerator).abs().normalise().positivise(),n=0;!r.isZero()&&t>0;t--){for(var s=e.length-1;s>=0&&0!=e[s].compare(r);s--);if(s>=0){i=i.substr(0,i.length+s-e.length)+"["+i.substr(i.length+s-e.length)+"]";break}e.push(new h(r)),n=r._digitMultiplyWithAdd(10,0).divide(this.remainder.denominator),i+=r.lsb(),r=n}0!=t||r.isZero()||(i+="...")}return i},a.prototype._normaliseRemainder=function(){if(!this.integer){var t=this.remainder.numerator.divide(this.remainder.denominator);this.number.add(this.remainder.numerator),this.remainder.numerator=t,this.remainder.numerator.isZero()?this.remainder.denominator.set(1):this.remainder.numerator.isNegative()?this.number.isPositive()&&(this.remainder.numerator.add(this.remainder.denominator),this.number.subtract(h.ONE)):this.number.isNegative()&&(this.remainder.numerator.subtract(this.remainder.denominator),this.number.add(h.ONE))}return this},a.N=h,a.plus=a.add,a.prototype.plus=a.prototype.add,a.minus=a.subtract,a.prototype.minus=a.prototype.subtract,a.sub=a.subtract,a.prototype.sub=a.prototype.subtract,a.times=a.multiply,a.prototype.times=a.prototype.multiply,a.mult=a.multiply,a.prototype.mult=a.prototype.multiply,a.div=a.divide,a.prototype.div=a.prototype.divide,a.mod=a.modulus,a.prototype.mod=a.prototype.modulus,"object"==typeof exports&&"undefined"!=typeof module?module.exports=a:"function"==typeof define&&define.amd?define(["Tpa"],a):"undefined"!=typeof window&&(window.Tpa=a)}();